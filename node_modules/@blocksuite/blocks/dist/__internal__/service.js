import { blockService } from '../services.js';
import { BaseService } from './service/index.js';
const services = new Map();
export function hasService(flavour) {
    return services.has(flavour);
}
export function registerService(flavour, Constructor) {
    if (services.has(flavour)) {
        return;
    }
    const service = new Constructor();
    services.set(flavour, service);
    return;
}
export function getService(flavour) {
    const service = services.get(flavour);
    if (!service) {
        throw new Error(`cannot find service by flavour ${flavour}`);
    }
    return service;
}
export function getServiceOrRegister(flavour) {
    const service = services.get(flavour);
    if (!service) {
        const Constructor = blockService[flavour] ?? BaseService;
        const result = registerService(flavour, Constructor);
        if (result instanceof Promise) {
            return result.then(() => services.get(flavour));
        }
        else {
            return services.get(flavour);
        }
    }
    return service;
}
//# sourceMappingURL=service.js.map